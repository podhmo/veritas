- ## `go test` with multiple modules

- date: 2025-07-18
- author: jules

### problem

When running `go test ./...` in a repository with multiple modules, only the tests for the main module are executed. `go test all` or `go test ./... all` can be used to run tests for all modules in the workspace, but this can be slow and may include unnecessary external dependencies.

### solution

The most reliable way to test all modules in a workspace is to use `go.work` and run `go test` on each module individually. This can be done by adding a separate step for each module in the CI workflow.

For example, in `.github/workflows/ci.yml`:

```yaml
    - name: Test
      run: go test ./...
    - name: Test examples
      run: go test -C ./examples/http-server ./...
```

This ensures that each module is tested in its own context, with the correct dependencies.

- ## Generics Optimization Issues

- date: 2025-07-18
- author: jules

### problem

While working on optimizing the generics support, I encountered several issues with the tests failing. The main problem was that the `TypeAdapter` was not being found for generic types. This was due to a mismatch between the type name generated by the parser and the type name used by the validator.

### solution

I tried several approaches to fix this issue, including:

1.  Modifying the `getTypeName` function to return the base name for generic types.
2.  Updating the adapters map in `validator_test.go` to use the fully qualified base name.
3.  Adding a fatal error if no adapter is found for a type that has validation rules.

None of these approaches worked, and the tests are still failing. I have decided to revert the changes to `validator.go` and try to fix the issue in a different way.

### current state

The code is in a state where the tests are failing. The `validator.go` file has been reverted to its original state. The `parser.go` and `rules.go` files have been updated to support the new generics implementation. The `validator_test.go` file has been updated with new test cases for generic types.

The main issue is that the `TypeAdapter` is not being found for generic types. This is because the `getTypeName` function is not returning the correct name for generic types.
